{% extends 'admin_base.html' %}
{% load static %}
{% block content %}
    <section class="content-header">
      <h1>
        <a href="/configuracion/respuesta_factura/">Respuesta Factura</a>
        <small>Configuracion</small>
      </h1>


      {% if messages %}
        {% for message in messages %}
            {% if message.tags %}
                <br>
                {% if message.level == DEFAULT_MESSAGE_LEVELS.INFO %}
                     <div class="alert alert-success alert-dismissible">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                        <h4><i class="icon fa fa-check"></i>Registro completado!</h4>{{ message }}
                     </div>
                {% endif %}
                {% if message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}
                    <div class="alert alert-success alert-dismissible">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                        <h4><i class="icon fa fa-check"></i>Edición Exitosa!</h4>{{ message }}
                    </div>
                {% endif %}
                {% if message.level == DEFAULT_MESSAGE_LEVELS.WARNING %}
                    <div class="alert alert-warning alert-dismissible">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                        <h4><i class="icon fa fa-check"></i>Registro Borrado!</h4>{{ message }}
                    </div>
                {% endif %}
                {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
                    <div class="alert alert-danger alert-dismissible">
                        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                        <h4><i class="icon fa fa-ban"></i>Alerta!</h4>{{ message }}
                    </div>
                {% endif %}
            {% endif %}
        {% endfor %}
      {% endif %}
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Configuracion</a></li>
        <li><a href="#">Solicitud</a></li>
      </ol>


    </section>
    <section>
    <div class="col-md-12">
          <div class="nav-tabs-custom">
              <!-- pestañas de el formulario-->
            <ul class="nav nav-tabs">
              <li ><a href="/configuracion/solicitudes/" >Solicitudes</a></li>
              <li class="active"><a href="#" data-toggle="tab">Responder Facturas </a></li>

            </ul>
            <form role="form" action="/configuracion/respuesta_factura/" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="tab-content">
                <!-- barras de acceso -->
                <div class="active tab-pane" id="paises">
                    <br><br>
                    <p>Seleccione los pedidos a responder:</p>
                    <br>
                    <!-- ... tu código HTML existente ... -->
                    <div id="formulario-duplicado">
                        <div class="row">
                            <div class="col-md-4">
                                <label>Pedido</label>
                                <div class="input-group ">
                                <span class="input-group-addon"><i class="fa fa-bars"></i></span>
                                <select class="form-control" name="pedido[]" required>
                                    <option value="" selected disabled></option>
                                    {% for pedido in pedidos %}
                                        <option value="{{ pedido.id }}">{{ pedido.num_pedido }}</option>
                                    {% endfor %}


                                </select>
                                </div>

                            </div>
                            <div class="col-md-4">
                                <label>Respuesta</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-file-text"></i></span>
                                    <input type="text" class="form-control" name="respuesta[]" placeholder="Respuesta" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label>Factura</label>
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-upload"></i></span>
                                    <input type="file" name="adjunto[]" required>
                                </div>
                            </div>
                        </div>
                        <br>
                    </div>


                    <script>
                        document.addEventListener('DOMContentLoaded', function() {
                            const formularioOriginal = document.getElementById('formulario-duplicado');
                            const contenedorFormularios = document.createElement('div');
                            function clonarFormulario() {
                                // Clonar la sección del formulario
                                const formularioClonado = formularioOriginal.cloneNode(true);
                                // Limpiar los valores de los campos clonados
                                const camposClonados = formularioClonado.querySelectorAll('input, select');
                                camposClonados.forEach(function(campo) {
                                    campo.value = '';
                                });
                                // Insertar el formulario clonado en el contenedor
                                contenedorFormularios.appendChild(formularioClonado);
            // Agregar el botón de eliminar al formulario clonado
            const btnEliminar = document.createElement('button');
            btnEliminar.innerHTML = '<i class="fa fa-minus"></i>';
            btnEliminar.classList.add('btn-eliminar');
            btnEliminar.setAttribute('type', 'button');
            formularioClonado.appendChild(btnEliminar);
            btnEliminar.addEventListener('click', function() {
                contenedorFormularios.removeChild(formularioClonado);
                if (contenedorFormularios.children.length === 1) {
                    contenedorFormularios.lastChild.querySelector('.btn-eliminar').remove();
                }
            });
                            }
                            const btnDuplicar = document.createElement('button');
                            btnDuplicar.innerHTML = '<i class="fa fa-plus"></i>';
                            btnDuplicar.classList.add('btn-duplicar');
                            btnDuplicar.setAttribute('type', 'button');
                            btnDuplicar.addEventListener('click', clonarFormulario);
                            const btnEliminar = document.createElement('button');
                            btnEliminar.innerHTML = '<i class="fa fa-minus"></i>';
                            btnEliminar.classList.add('btn-eliminar');
                            btnEliminar.setAttribute('type', 'button');
                            btnEliminar.style.display = 'none';

                            // Insertar el botón y el primer formulario

                            formularioOriginal.parentNode.insertBefore(contenedorFormularios, formularioOriginal);
                            formularioOriginal.parentNode.insertBefore(btnEliminar, formularioOriginal);
                            formularioOriginal.parentNode.insertBefore(btnDuplicar, formularioOriginal);
                            contenedorFormularios.appendChild(formularioOriginal);

                        });
                    </script>



                </div>
                <br>
            <input type="submit" class="btn btn-primary btn-block btn-flat" value="ENVIAR">
                <!-- /.tab-content -->
          </div>
            </form>

          <!-- /.nav-tabs-custom -->
    </div>
    </div>
    </section>

{% endblock %}